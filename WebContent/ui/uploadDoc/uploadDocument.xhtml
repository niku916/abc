<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html lang="#{lanBean.language}" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
<f:view locale="#{lanBean.locale}">
	<h:head>
		<meta name="viewport"
			content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
		<meta name="robots" content="noindex"/>
		<title><ui:insert name="windowTitle">#{label.vahanTitle}</ui:insert></title>
		<link rel="shortcut icon" type="image/x-icon"
			href="#{resource['images/in_flag.ico']}" />
		<!-- 		<h:outputStylesheet library="css" name="grid-css.css" /> -->
		<!-- 		<h:outputStylesheet library="css" name="layout.css" /> -->
		<!-- 		<h:outputStylesheet library="css" name="responsive.css" /> -->
		<h:outputScript library="js" name="utils.js" />
		<script>
			var formSubmitted = false;
			function onSubmitButton() {
				if (!formSubmitted) {
					formSubmitted = true;
				} else {
					// disable event propagation if form is already submitted
					event.preventDefault();
				}
			}
		</script>


	</h:head>
	<h:form id="formUploadDoc" prependId="false">
		<div class="ui-grid ui-grid-responsive">
			<ui:include src="/ui/uploadDoc/leftMenuPanel.xhtml"></ui:include>
			<ui:insert name="heading">
				<ui:param name="parentformid" value="formUploadDoc" />
			</ui:insert>

			<div class="ui-grid-row ">
				<p:messages autoUpdate="true" showDetail="true" showSummary="false"
					closable="true" />
			</div>
			<div>
				<p:inputText type="hidden" value="#{dmsHomePageBean.listOfDoc}" />
				<p:inputText type="hidden" value="#{dmsHomePageBean.esignDoc}" />
			</div>

			<!-- 			<div> -->
			<!-- 				<h:inputHidden value="dmsHomePageBean.dmsDocumentUpload" /> -->
			<!-- 			</div> -->
			<div class="ui-grid-row">
				<div class="ui-grid-col-12"
					style="height: 15px; background-color: #f1f1f1;"></div>
			</div>


			<p:outputPanel id="toppanel">
				<p:outputPanel autoUpdate="true">
					<p:outputPanel rendered="#{dmsHomePageBean.queryParam}">
						<div class="ui-grid-row">
							<div class="alert alert-success ui-grid-col-12 center-position"
								role="alert" align="center">
								<!-- Documents have been E-Signed <span th:if="${isDmsUploaded}"> and uploaded on DMS</span><span> Successfully.! </span> -->
								<span>(Vehicle No: <b class="ng-binding">
										#{dmsHomePageBean.dmsDocumentUpload.dmsRequest.regnNo} </b>,
									Application Number: <b class="ng-binding">#{dmsHomePageBean.dmsDocumentUpload.dmsRequest.applNo}</b>,
									Purpose Description: <b class="ng-binding">#{dmsHomePageBean.dmsDocumentUpload.dmsDocument.purposeName}</b>)
								</span>
							</div>
						</div>
					</p:outputPanel>
				</p:outputPanel>
			</p:outputPanel>

			<div style="width: 96%; margin: 0 auto;">
				<p:outputPanel id="mainpanel">
					<p:outputPanel autoUpdate="true">

						<div class="headerDuplicate">
							<p:outputPanel>
								<div class="ui-grid-row">
									<div class="ui-grid-col-12 center-position font-bold">




										<h:outputText value="#{lang['lebelname.Servererror']}"
											style="color:red"
											rendered="#{dmsHomePageBean.dmsDocumentUpload.dmsDocument == null}"></h:outputText>

									</div>
								</div>

							</p:outputPanel>

							<p:outputPanel
								rendered="#{dmsHomePageBean.queryParam and dmsHomePageBean.dmsDocumentUpload.dmsDocument != null}">
								<p:outputPanel
									rendered="#{dmsHomePageBean.dmsDocumentUpload.dmsRequest.docType eq 'N'}">
									<div class="ui-grid-row">
										<div class="ui-grid-col-12">
											<h2>
												<h:outputLabel value="#{lang['homepage.UploadDoc']}" />
											</h2>
										</div>
									</div>
								</p:outputPanel>
								<p:outputPanel
									rendered="#{dmsHomePageBean.dmsDocumentUpload.dmsRequest.docType eq 'B'}">
									<div class="ui-grid-row">
										<div class="ui-grid-col-12">
											<h2>
												<h:outputLabel value="#{lang['labelname.uploadPending']}" />
											</h2>
										</div>
									</div>
								</p:outputPanel>
								<p:outputPanel
									rendered="#{dmsHomePageBean.dmsDocumentUpload.dmsRequest.docType eq 'U'}">
									<div class="ui-grid-row">
										<div class="ui-grid-col-12">
											<h2>
												<h:outputLabel value="#{lang['labelname.modifyUpload']}" />
											</h2>
										</div>
									</div>
								</p:outputPanel>



								<div class="ui-grid-row">
									<div class="ui-grid-col-12 center-position font-bold">

										<h:outputText value="#{lang['lebelname.nullDocList']}"
											rendered="#{dmsHomePageBean.dmsDocumentUpload.docNotConfigure}"></h:outputText>

									</div>
								</div>


								<div class="ui-grid-row">
									<div class="ui-grid-col-12 center-position font-bold">

										<h:outputText value="#{lang['lebelname.DocFound']}"
											rendered="#{dmsHomePageBean.dmsDocumentUpload.docUploaded}"></h:outputText>

									</div>
								</div>
							</p:outputPanel>


							<div class="ui-grid-row">
								<div class="ui-grid-col-12 center-position font-bold">

									<h:outputText value="#{lang['labelname.incorrectUrl']}"
										rendered="#{dmsHomePageBean.queryParam eq false}"></h:outputText>

								</div>
							</div>

							<p:outputPanel styleClass="center-position"
								rendered="#{dmsHomePageBean.dmsDocumentUpload.dmsDocument.documentList.size() != 0 and dmsHomePageBean.queryParam and dmsHomePageBean.dmsDocumentUpload.dmsDocument != null}">
								<!-- 								<div class="ui-grid-row bottom-space top-space"> -->
								<!-- 									<div class="ui-grid-col-12 center-position red font-bold"> -->
								<!-- 																				#{lang['lebelname.validFileSize']} -->
								<!-- 										<h:outputText value="#{lang['lebelname.validFileSize']}" -->
								<!-- 											rendered="#{!(dmsHomePageBean.dmsDocumentUpload.dmsRequest.stateCd eq 'CH')}"></h:outputText> -->
								<!-- 										<h:outputText value="#{lang['lebelname.validFileSizeForCH']}" -->
								<!-- 											rendered="#{dmsHomePageBean.dmsDocumentUpload.dmsRequest.stateCd eq 'CH'}"></h:outputText> -->
								<!-- 									</div> -->
								<!-- 								</div> -->
								<div class="ui-grid-col-12 center-position red font-bold">
									<p:outputPanel
										rendered="#{dmsHomePageBean.dmsDocumentUpload.dmsRequest.esignUserOptFlag}">
										<p:outputLabel
											value="#{lang['levelname.esign.userselectesigntrue']}" />
									</p:outputPanel>
									<p:outputPanel
										rendered="#{dmsHomePageBean.dmsDocumentUpload.dmsRequest.mergeflag}">
										<p:outputLabel value="#{lang['lebelname.esign.esignmerge']}" />
									</p:outputPanel>


								</div>

								<div class="align-padding-left-right FEE_PANEL_DTL">

									<p:dataTable tableStyle="table-layout: auto;"
										value="#{dmsHomePageBean.dmsDocumentUpload.dmsDocument.documentList}"
										var="row" rowIndexVar="rowindx">

										<p:columnGroup type="header">
											<p:row>
												<!--id-->
												<p:column headerText="Sr.No."
													styleClass="collumn-width font-bold" />
												<p:column headerText="Document Type" width="20%"
													styleClass="font-bold" />
												<p:column headerText="Document Name" width="20%"
													styleClass="font-bold" />
												<p:column headerText="Select File" styleClass="font-bold"
													width="20%" />
												<!-- 												<p:column headerText="Select File" styleClass="font-bold" -->
												<!-- 													width="20%" -->
												<!-- 													rendered="#{row.dmsUpload.dmsFlag.browseOption and dmsHomePageBean.dmsDocumentUpload.dmsRequest.stateCd eq 'CH'}" /> -->

												<p:column headerText="Sign Document"
													rendered="#{dmsHomePageBean.dmsDocumentUpload.dmsRequest.esignFlag}"
													styleClass="font-bold" />
												<p:column headerText="View Signed Doc"
													rendered="#{dmsHomePageBean.dmsDocumentUpload.dmsRequest.esignFlag}"
													styleClass="font-bold" />
												<p:column headerText="Upload Document"
													styleClass="font-bold" />
												<p:column headerText="View Document" styleClass="font-bold" />

											</p:row>
										</p:columnGroup>


										<p:column styleClass="collumn-width center-position">
											<h:outputText
												value="#{dmsHomePageBean.dmsDocumentUpload.dmsDocument.documentList.indexOf(row)+1}"></h:outputText>
										</p:column>
										<p:column id="colr" styleClass="left-position">
											<!-- <p:outputPanel id="ref1" rendered="#{row.docUploaded == true}"><a href="#{row.dmsUpload.docUrl}" target="_blank"> <p style="color: blue">#{row.catName}</p></a></p:outputPanel> -->
											<h:outputText value="#{row.catName} "></h:outputText>
											<h:outputText rendered="#{row.mandatory == 'Y'}"
												styleClass="field-label-mandate"></h:outputText>
										</p:column>
										<p:column styleClass="left-position">
											<!-- <h:selectOneMenu value="#{row.subcategoryMasterData.subCatId}" rendered="#{row.dmsUpload.dmsUploadedAlready == false}">
												<f:selectItems value="#{row.subcategoryMasterDataList}" var="subCat" itemValue="#{subCat.subCatId}" itemLabel="#{subCat.subCatName}"/>
											</h:selectOneMenu> -->


											<h:selectOneMenu
												value="#{row.subcategoryMasterData.subCatId}"
												rendered="#{row.dmsUpload.dmsUploadedAlready == false}"
												valueChangeListener="#{dmsHomePageBean.selectSubDoc}">
												<f:selectItems value="#{row.subcategoryMasterDataList}"
													var="subCat" itemValue="#{subCat.subCatId}"
													itemLabel="#{subCat.subCatName}" />
												<p:ajax />
											</h:selectOneMenu>
											<h:outputText rendered="#{row.dmsUpload.dmsUploadedAlready}"
												value="#{row.subcategoryMasterDataList[0].subCatName} "></h:outputText>
										</p:column>

										<!-- 										<p:column -->
										<!-- 											rendered="#{(row.dmsUpload.dmsFlag.browseOption) and !(dmsHomePageBean.dmsDocumentUpload.dmsRequest.stateCd eq 'CH')}"> -->
										<!-- 											<p:growl id="msg"></p:growl> -->
										<!-- 											<p:fileUpload -->
										<!-- 												rendered="#{row.dmsUpload.dmsFlag.browseOption}" -->
										<!-- 												value="#{row.dmsUpload.file}" -->
										<!-- 												invalidSizeMessage="Invalid Size (limit upto 200kb)" -->
										<!-- 												invalidFileMessage="Invalid File Type" -->
										<!-- 												fileLimitMessage="Invalid File Limit" mode="advanced" -->
										<!-- 												fileUploadListener="#{dmsHomePageBean.fileUploadListener}" -->
										<!-- 												multiple="false" auto="true" skinSimple="true" -->
										<!-- 												sizeLimit="204800" allowTypes="/(\.|\/)(pdf|png|jpg|jpeg)$/" -->
										<!-- 												update="msg"> -->
										<!-- 												<f:attribute name="indx" -->
										<!-- 													value="#{dmsHomePageBean.dmsDocumentUpload.dmsDocument.documentList.indexOf(row)}" /> -->
										<!-- 											</p:fileUpload> -->
										<!-- 											<h:outputText value="#{row.dmsUpload.selectedFileName}"></h:outputText> -->
										<!-- 										</p:column> -->
										<p:column rendered="#{row.dmsUpload.dmsFlag.browseOption}">
											<p:growl id="msg2"></p:growl>
											<p:fileUpload value="#{row.dmsUpload.file}"
												rendered="#{row.dmsUpload.dmsFlag.browseOption}"
												invalidSizeMessage="Invalid Size"
												invalidFileMessage="Invalid File Type"
												fileLimitMessage="Invalid File Limit" mode="advanced"
												fileUploadListener="#{dmsHomePageBean.fileUploadListener}"
												multiple="false" auto="true" skinSimple="true"
												sizeLimit="20480000"
												 update="msg2">
												<f:attribute name="indx"
													value="#{dmsHomePageBean.dmsDocumentUpload.dmsDocument.documentList.indexOf(row)}" />
											</p:fileUpload>
											<h:outputText value="#{row.dmsUpload.selectedFileName}"></h:outputText>
										</p:column>
										<!-- rendered="#{row.dmsUpload.dmsFlag.signDoc}" -->
										<p:column rendered="#{row.dmsUpload.dmsFlag.signDocCol}">
											<p:commandButton style="vertical-align: top !important;"
												rendered="#{row.dmsUpload.dmsFlag.signDoc}"
												value="#{row.dmsUpload.signBtn}"
												disabled="#{row.dmsUpload.dmsFlag.disableSignButton}"
												action="#{dmsHomePageBean.prepareEsign()}" immediate="true">
												<f:setPropertyActionListener
													value="#{dmsHomePageBean.dmsDocumentUpload.dmsDocument.documentList.indexOf(row)}"
													target="#{dmsHomePageBean.index}" />
											</p:commandButton>
										</p:column>

										<!-- rendered="#{row.dmsUpload.dmsFlag.viewSignDocBtn}" -->

										<p:column rendered="#{row.dmsUpload.dmsFlag.signDocCol}"
											styleClass="center-position">
											<p:outputPanel
												rendered="#{row.dmsUpload.dmsFlag.viewSignDocBtn}">
												<a href="#{row.dmsUpload.signedDocUrl}" target="_blank"
													class="blue font-bold" style="font-size: 1.4rem"><i
													class="fa fa-file-text" aria-hidden="true"></i></a>
											</p:outputPanel>

										</p:column>

										<p:column styleClass="center-position">
											<p:commandButton style="vertical-align: top !important;"
												rendered="#{row.dmsUpload.dmsFlag.uploadDocBtn}"
												value="#{lang['lebelname.dmsUpload']}"
												disabled="#{row.dmsUpload.dmsFlag.disableUploadBtn}"
												action="#{dmsHomePageBean.uploadToDms()}" immediate="true"
												icon="ui-icon ui-icon-circle-arrow-n">
												<f:setPropertyActionListener
													value="#{dmsHomePageBean.dmsDocumentUpload.dmsDocument.documentList.indexOf(row)}"
													target="#{dmsHomePageBean.index}" />
											</p:commandButton>
										</p:column>
										<p:column styleClass="center-position">
											<p:outputPanel rendered="#{row.dmsUpload.dmsFlag.viewDocBtn}">
												<!-- 												<a href="#{row.dmsUpload.docUrl}" target="_blank" -->
												<!-- 													class="blue font-bold" style="font-size: 1.4rem"><i -->
												<!-- 													class="fa fa-eye" aria-hidden="true"></i></a> -->
												<p:commandButton id="view_docs" icon="fa fa-eye"
													action="#{dmsHomePageBean.getViewDocs(row)}"
													update="viewDocs viewapplwisedata">
												</p:commandButton>
											</p:outputPanel>
										</p:column>
									</p:dataTable>
									<br />
								</div>
							</p:outputPanel>
						</div>
					</p:outputPanel>
				</p:outputPanel>
				<p:outputPanel id="viewDocs">
					<p:dialog widgetVar="viewDocs" closable="true" width="730px"
						modal="true" height="400px">
						<ui:include src="/ui/uploadDoc/viewFile.xhtml">
						</ui:include>
						<!-- 						<p:media value="#{dmsHomePageBean.streamedContent}" player="pdf" -->
						<!-- 							width="100%" height="300px" style="width: 700px;height: 90%;"> -->
						<!-- 							<f:param name="id" -->
						<!-- 								value="#{dmsHomePageBean.generateRandomIdForNotCaching()}" /> -->
						<!-- 						</p:media> -->
					</p:dialog>
				</p:outputPanel>
				<p:blockUI block="mainpanel" widgetVar="block_panel">
					<p:graphicImage name="ajax_loader_blue.gif" library="images"
						height="40%" width="30%" />
				</p:blockUI>
				<p:dialog widgetVar="userconf" closable="true" dynamic="true"
					id="userconfid" header="Confirmation!!!" width="50%" height="20%">

					<p:outputPanel id="confdilgId">
						<p:outputPanel>


							<div class="ui-grid-row">
								<div class="ui-grid-col-12">
									<p:selectBooleanCheckbox value="#{dmsHomePageBean.enableConf}">
										<!-- 										<p:ajax event="change" -->
										<!-- 											listener="#{dmsHomePageBean.uploadToDms()}" -->
										<!-- 											update="confdilgId"> -->
										<!-- 										</p:ajax> -->
									</p:selectBooleanCheckbox>
									<h:outputText
										value="  #{lang['lebelname.uploadDocDeclaration1']}"
										style="font-size: 0.5cm !important;font-weight: bold;"></h:outputText>
									<!-- 										<h6 class="inline-section"> -->

									<!-- 										</h6> -->
								</div>
							</div>


							<p></p>
							<div class="center-position">
								<p:commandButton value="OK"
									actionListener="#{dmsHomePageBean.uploadToDms()}">
								</p:commandButton>
								<p:commandButton value="Cancel" onclick="PF('userconf').hide();"
									immediate="true">
								</p:commandButton>
							</div>
						</p:outputPanel>
					</p:outputPanel>
				</p:dialog>



			</div>
		</div>
		<p:dialog id="viewapplwisedata" widgetVar="viewdocappldlg"
			modal="true">
			<p:dataTable id="documentUploadDT"
				value="#{dmsHomePageBean.docsListapplwise}" var="docDescr"
				rowIndexVar="index">
				<p:column headerText="Sr.No"
					styleClass="collumn-width center-position">
					<p:outputLabel value="#{index +1}." />
				</p:column>
				<p:column headerText="Document Name">
					<h:outputLabel value="#{docDescr.doc_url}" />
				</p:column>
				<p:column headerText="">
					<a href="#{dmsHomePageBean.viewdocUrl}#{docDescr.doc_object_id}"
						target="_blank" class="blue font-bold">#{lang['lebelname.viewUploaded']}</a>
				</p:column>
			</p:dataTable>
		</p:dialog>
		<div>
			<p:commandButton value="Proceed Further"
				action="#{dmsHomePageBean.backToClient()}" immediate="true">
			</p:commandButton>
			<p:commandButton value="View Auto Uploaded Docs" rendered="#{dmsHomePageBean.viewAutoUploadDocs}"
				update="viewapplwisedata"
				action="#{dmsHomePageBean.viewDocumentUploaded()}">
			</p:commandButton>
		</div>
		<!-- 		<div> -->
		<!-- 			<p style="color: blue;">Kindly do Final Submit by using the -->
		<!-- 				</p> -->
		<!-- 		</div> -->
	</h:form>

	<div class="ui-grid-row">
		<div class="ui-grid-col-12">
			<div id="footer_view">
				<ui:insert name="footer">
					<ui:include src="/ui/uploadDoc/footer.xhtml" />
				</ui:insert>
			</div>
		</div>
	</div>
</f:view>
</html>
